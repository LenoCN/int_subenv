# 更新日志

本文档记录了中断验证子环境的重要更新和修复历史。

## [2.0.0] - 2025-08-01

### 🧹 重大清理和重构
- **工具集精简**: 从26个工具文件精简到5个核心工具，删除21个废弃文件
- **文档整合**: 合并40+个分散的.md文件，建立清晰的文档结构
- **流程自动化**: 新增`generate_interrupt_config.py`一键生成完整配置

### 🔧 路由配置修复
- **修复Excel解析问题**: 解决重复的SCP/MCP M7解析逻辑
- **修复列名映射**: `to ACCEL?` → `to IMU?`
- **改进路由判断**: 只有"YES"才添加路由，"Possible"不添加
- **iosub_normal_intr完全修复**: 正确的SCP索引109和MCP索引64

### 📊 问题解决统计
- 路由配置问题: 从55个减少到7个 (87%改善)
- 代码行数减少: 4,442行
- 工具集精简度: 81%

## [1.9.0] - 2025-07-30

### 🔧 IOSUB RAS Merge逻辑简化
- **简化merge逻辑**: iosub_ras_*_intr现在仅merge smmu的ras中断
- **移除冗余源**: 删除了不必要的中断源，简化了merge关系
- **提高可维护性**: 更清晰的merge信号定义

### 🛡️ Mask一致性修复
- **统一mask逻辑**: 统一add_expected_with_mask和wait_for_interrupt_detection的mask逻辑
- **修复mask处理**: 确保所有mask操作的一致性
- **增强调试信息**: 添加详细的mask状态日志

## [1.8.0] - 2025-07-25

### 🏷️ 术语统一：IMU → ACCEL
- **全面术语更新**: 移除所有IMU引用，统一使用ACCEL
- **代码一致性**: 确保所有代码、注释、文档使用统一术语
- **向后兼容**: 保持功能不变，仅更新术语

### 🎯 ACCEL子系统完善
- **32位mask寄存器支持**: 完整的ACCEL子系统mask处理
- **路由模型完善**: 全面支持ACCEL目标的路由和mask

## [1.7.0] - 2025-07-20

### 🔌 子系统支持扩展
- **PSUB/PCIE1子系统**: 20位mask寄存器支持
- **CSUB子系统**: 智能复用现有SCP/MCP逻辑
- **路由模型完善**: 全面支持所有子系统的mask感知路由

### 🧪 验证工具完善
- **专门验证脚本**: 新增多个验证脚本确保实现正确性
- **自动化测试**: 完善的测试覆盖和验证流程

## [1.6.0] - 2025-07-15

### 🔄 IOSUB Normal中断优化
- **判断逻辑修复**: 从基于interrupt_name改为基于index范围[0,9]∪[15,50]
- **串行mask处理**: 两层mask串行检查：IOSUB Normal → SCP/MCP General
- **性能优化**: 更高效的中断判断和处理逻辑

### 📈 代码质量提升
- **消除重复逻辑**: 用函数调用替换185行重复代码
- **代码质量提升**: 97%的代码质量改善
- **可维护性增强**: 更清晰的代码结构

## [1.5.0] - 2025-07-10

### 🎯 目标特定优化
- **ACCEL目标支持**: 在check_general_mask_layer中添加ACCEL路由mask处理
- **目的地特定mask**: SCP/MCP使用串行mask，ACCEL使用单层mask
- **架构一致性**: 符合硬件架构的mask处理方式

### 🐛 竞争条件修复
- **事件同步修复**: 修复int_monitor.sv中trigger()和wait_trigger()的竞争条件
- **时序优化**: 确保事件的正确同步和处理
- **稳定性提升**: 消除了随机性测试失败

## [1.4.0] - 2025-07-05

### 🔧 配置和调试增强
- **Config DB修复**: 解决UVM配置数据库相关问题
- **调试功能增强**: 新增通用中断调试功能
- **错误诊断**: 改进UNEXPECTED interrupt错误的诊断能力

### 📚 文档完善
- **调试指南**: 详细的调试使用示例和指南
- **开发历程**: 完整的项目开发历史记录
- **技术文档**: 各种技术实现的详细文档

## [1.3.0] - 2025-06-30

### 🏗️ 架构重构
- **静态到实例重构**: 重大架构改进，提高灵活性
- **层次结构更新**: 优化信号层次结构
- **SMMU信号修复**: 修复SMMU相关的信号前缀和层次问题

### 🔀 Merge功能完善
- **中断merge功能**: 完善的中断合并处理
- **异常信号修复**: 修复iosub_abnormal merge信号的UVM_ERROR问题
- **信号处理优化**: 更robust的merge信号处理逻辑

## [1.2.0] - 2025-06-25

### 🎭 Mask实现完善
- **完整mask实现**: 全面的中断mask和状态寄存器功能
- **硬件模型**: 从软件模型重写为硬件模型
- **寄存器映射**: 详细的中断mask寄存器映射

### 🔄 路由更新
- **TC路由修改**: 测试用例路由的重要修改
- **IO监控**: iosub_to_io监控机制的调整
- **目标路由**: 各种目标的路由逻辑优化

## [1.1.0] - 2025-06-20

### 🚀 初始功能实现
- **基础验证环境**: 完整的中断验证子环境框架
- **UVM标准**: 基于UVM标准的验证环境
- **多目标支持**: 支持AP、SCP、MCP、ACCEL等多个目标

### 🛠️ 工具链建立
- **Excel转换工具**: convert_xlsx_to_sv.py
- **信号路径生成**: generate_signal_paths.py
- **RTL路径更新**: update_rtl_paths.py

## [1.0.0] - 2025-06-15

### 🎉 项目启动
- **项目初始化**: 中断验证子环境项目启动
- **基础架构**: 建立基本的项目结构和框架
- **开发环境**: 配置开发和构建环境

---

## 📝 版本说明

- **主版本号**: 重大架构变更或不兼容更新
- **次版本号**: 新功能添加或重要改进
- **修订版本号**: Bug修复和小改进

## 🔗 相关链接

- [项目主页](README.md)
- [技术文档](TECHNICAL_DOCS.md)
- [工具使用](tools/README.md)

---
*最后更新: 2025-08-01*
